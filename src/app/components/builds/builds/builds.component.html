<div class="ui two column stackable center aligned grid">
  <div class="twelve wide left aligned column">
    <h2>Builds</h2>
  </div>

  <div class="four wide right aligned column">
    <div class="ui icon basic buttons">
      <button appPopup class="ui button" data-content="Create a Build" routerLink="/builds/new"><i class="add icon"></i></button>
    </div>
  </div>
</div>

<div class="ui left icon input">
  <i class="search icon"></i>
  <input #search type="text" (keyup)="keyUp.next($event)" [(ngModel)]="filterQuery" placeholder="Enter filter term...">
</div>

<div class="ui unstackable divided items" *ngIf="results">
  <div *ngFor="let build of results.items" class="item">
    <div class="status-icon" [ngClass]="{
      'positive': build.isSucceeded(),
      'negative': build.isFailed() || build.isErrored()
    }"></div>

    <div class="content">
      <i class="icon check positive" *ngIf="build.isSucceeded()"></i>
      <i class="icon bug negative" *ngIf="build.isFailed() || build.isErrored()"></i>
      <a class="header" routerLink="/builds/{{build.buildId}}">{{build.project.name}}</a>

      <div class="description">
        <p *ngIf="build.commitMessage">{{build.commitMessage}}</p>
      </div>

      <div class="extra">
        <div class="ui grid">
          <div class="two column row">
            <div class="column">
              <p>Queued {{build.createdAt | amCalendar | lowercase}}</p>
              <p *ngIf="!build.isQueued()">Last updated {{build.lastUpdatedAt() | amCalendar | lowercase}}</p>
            </div>

            <div class="column">
              <p *ngIf="build.commitHash"><i class="icon code"></i> {{build.commitHash.substring(0, 8)}} on {{build.commitBranch}}</p>
              <p *ngIf="build.commitMessage"><i class="icon user"></i> Authored by {{build.commitAuthorName}} <{{build.commitAuthorEmail}}></p>
              <p *ngIf="build.commitMessage"><i class="icon user"></i> Committed by {{build.commitCommitterName}} <{{build.commitCommitterEmail}}></p>
              <p *ngIf="build.commitMessage"><i class="icon clock"></i> Authored {{build.commitAuthoredAt | amCalendar | lowercase}}</p>
              <p *ngIf="build.commitMessage"><i class="icon clock"></i> Committed {{build.commitCommittedAt | amCalendar | lowercase}}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="ui pagination pointing secondary menu" *ngIf="results.numPages > 1">
    <a *ngFor="let i of seq(results.numPages)" [ngClass]="{'item': true, 'active': results.page == i}" (click)="loadPage(i)">{{i}}</a>
  </div>
</div>