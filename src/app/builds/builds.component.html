<h2>Builds</h2>

<div>
  <a class="ui primary button" routerLink="/builds/new">Create Build</a>
</div>

<!-- TODO - better style -->
<div class="ui left icon input">
  <i class="search icon"></i>
  <input #search type="text" (keyup)="filter()" [(ngModel)]="filterQuery" placeholder="Enter filter term...">
</div>

<div class="ui unstackable divided items">
  <div *ngFor="let build of filteredBuilds" class="item">
    <div class="status-icon" [ngClass]="{
      'positive': build.isSucceeded(),
      'negative': build.isFailed() || build.isErrored()
    }"></div>

    <div class="content">
      <i class="icon check positive" *ngIf="build.isSucceeded()"></i>
      <i class="icon bug negative" *ngIf="build.isFailed() || build.isErrored()"></i>
      <a class="header" routerLink="/builds/{{build.buildId}}">{{build.project.name}}</a>

      <div class="description">
        <p *ngIf="build.commitMessage">{{build.commitMessage}}</p>
      </div>

      <div class="extra">
        <div class="ui grid">
          <div class="two column row">
            <div class="column">
              <p>Queued {{build.createdAt | amCalendar | lowercase}}</p>
              <p *ngIf="!build.isQueued()">Last updated {{build.lastUpdatedAt() | amCalendar | lowercase}}</p>
            </div>

            <div class="column">
              <p *ngIf="build.commitHash"><i class="icon code"></i> {{build.commitHash.substring(0, 8)}} on {{build.commitBranch}}</p>
              <p *ngIf="build.commitMessage"><i class="icon user"></i> Authored by {{build.commitAuthorName}} <{{build.commitAuthorEmail}}></p>
              <p *ngIf="build.commitMessage"><i class="icon user"></i> Committed by {{build.commitCommitterName}} <{{build.commitCommitterEmail}}></p>
              <p *ngIf="build.commitMessage"><i class="icon clock"></i> Authored {{build.commitAuthoredAt | amCalendar | lowercase}}</p>
              <p *ngIf="build.commitMessage"><i class="icon clock"></i> Committed {{build.commitCommittedAt | amCalendar | lowercase}}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
